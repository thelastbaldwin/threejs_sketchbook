<!DOCTYPE html>
<html>
<head>
	<title>Perspective Grid</title>
	<script src="../../node_modules/three/build/three.min.js"></script>
	<script src="../../node_modules/dat.gui/build/dat.gui.min.js"></script>
	<link rel="stylesheet" href="../../css/style.css">
</head>
<body>
	<div id="Stats-output"></div>
    <div id="WebGL-output"></div>
    <script id="vertex-shader" type="x-shader">
        void main() {
            gl_Position = projectionMatrix *
            modelViewMatrix *
            vec4(position,1.0);
        }
    </script>
    <script id="fragment-shader" type="x-shader">
        #ifdef GL_ES
        precision mediump float;
        #endif

        const float PI = 3.1415926535897932384626433832795;
        const float TAU = 2. * PI;

        uniform vec2 u_resolution;

        float starBurst(vec2 st, vec2 target, float decay, float numLines){
            //decay should get exponentially closer to 1 as the distance increases
            //tricky for center vanishing point
            vec2 dist = st - target;

            return step(decay, sin(atan(dist.y, dist.x) * numLines));
        }

        void main() {
            vec3 color = vec3(0.);

            //normalized texture coordinate
            vec2 st = gl_FragCoord.xy / u_resolution;

            float hl = 0.500;
            vec2 rvp = vec2(-1.25, hl);
            vec2 lvp = vec2(1.75, hl);
            vec2 cvp = vec2(.5, hl);

            const float numLines = 160.;

            color += starBurst(st, rvp, 0.998, numLines);
            color += starBurst(st, lvp, 0.998, numLines);
            // color += starBurst(st, cvp, 0.972, numLines);
            color += 1.0 - step(0.0025, distance(st.y, hl));

            gl_FragColor = vec4(color, 1.);
        }
    </script>
	<script src="./perspectiveGrid.js">
	</script>
</body>
</html>